# Dumping Azure storage keys

## Tools: Microburst

### Steps:

# 1) MicroBurst

 - Connect-AzAccount (Authenticate with the Contributor access account)

 - Import-Module MicroBurst.psm1

 - Get-AzPasswords -AutomationAccounts N -AppServices N -Keys N -ACR N -CosmosDB N -Verbose | Out-GridView (Dump Azure storage instances. This function can also be used to extract data plane keys for other PaaS services, but we will exclude those services for now by using the N option for those parameters)

 - When prompted, select the appropriate Azure subscription and click OK

 - Credentials got dumped from storage accounts. Can be used for hunting more credentials, or exfiltrate data, etc...

 - choco install microsoftazurestorageexplorer -y (Install Microsoft Azure storage Explorer)

 - On start button, search for the storage explorer, then click on the app

 - In the connect to Azure Storage window, select storage account

 - In the Select Authentication Method window, select Account name and key then click Next

 - In the Enter Connection Info window, enter the following information:

#### 1) Display name: DISPLAY_NAME

#### 2) Account Name: ACCOUNT_NAME

#### 3) Account Key: ACCOUNT_KEY

 - Click Next

 - In the Summary window, click Connect

### Review the files and note that we now have persistent access to the storage account and the content of all its services. This gives a lot of room for an attacker to cause damage. For example, an attacker could encrypt data in the service in a ransomware attack, inject malicious data into NoSQL table stores, or poison applications using storage queues

# 2) Lava

 - python3 Lava.py

 - exec stg_blob_download (Execute the module to dump)
